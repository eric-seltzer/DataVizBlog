{
  "hash": "080d88b4936d65e47d96af8d3796f67f",
  "result": {
    "markdown": "---\ntitle: \"Is There Bias Towards the Big 6?\"\nauthor: \"Eric Seltzer\"\ndate: \"2024-02-21\"\ncategories: [sports, code, analysis]\n---\n\n\n# Introduction\n\nWhile scrolling through the Tidy Tuesday data, I found a data set of the Premier League Matches from 2021-2022. In this data, they included team goals and results for both the first half and the second half. They also included the referee, team shots, team shots on target, team fouls, team yellow cards, and team red cards. When thinking about the variables that this data had, I thought of the question is there bias towards the \"big 6\". For those of you who don't follow the Premier League, the big 6 consists of Arsenal, Liverpool, Manchester United, Manchester City, Chelsea, and Tottenham. My goal was to see if there was a notable difference in the number of fouls produced for the big six vs their opponents.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(here)\nlibrary(knitr)\ntheme_set(theme_minimal())\nsoccer <- read_csv(here(\"data/soccer.csv\"))\n```\n:::\n\n\n# Data Cleaning\n\nMy first step was to get rid of the halftime data, the shots data, the goals data, the winners data, and the corners data because I wouldn't be needing it for my analysis. I chose to keep the referee variable and cards variables just in case I want to use it later. I also wanted to make the variable names easier to interpret.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsoccerTidy <-\n  soccer |>\n  select(-starts_with(\"HT\")) |>\n  select(-(4:6)) |>\n  select(-(5:8)) |>\n  select(-(7:8)) |>\n  rename('HomeFouls' = HF) |>\n  rename('AwayFouls' = AF) |>\n  rename('HomeYellow' = HY) |>\n  rename('AwayYellow' = AY) |>\n  rename('HomeRed' = HR) |>\n  rename('AwayRed' = AR)\n```\n:::\n\n\nBelow is a sample of what the data now looks like.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(head(soccerTidy))\n```\n\n::: {.cell-output-display}\n|Date       |HomeTeam   |AwayTeam       |Referee   | HomeFouls| AwayFouls| HomeYellow| AwayYellow| HomeRed| AwayRed|\n|:----------|:----------|:--------------|:---------|---------:|---------:|----------:|----------:|-------:|-------:|\n|13/08/2021 |Brentford  |Arsenal        |M Oliver  |        12|         8|          0|          0|       0|       0|\n|14/08/2021 |Man United |Leeds          |P Tierney |        11|         9|          1|          2|       0|       0|\n|14/08/2021 |Burnley    |Brighton       |D Coote   |        10|         7|          2|          1|       0|       0|\n|14/08/2021 |Chelsea    |Crystal Palace |J Moss    |        15|        11|          0|          0|       0|       0|\n|14/08/2021 |Everton    |Southampton    |A Madley  |        13|        15|          2|          0|       0|       0|\n|14/08/2021 |Leicester  |Wolves         |C Pawson  |         6|        10|          1|          2|       0|       0|\n:::\n:::\n\n\n# Preparing for Visuals\n\nNext I needed to make multiple data frames, a home and away for the big 6 which could then be joined so I could compare how many fouls they got when versing non big 6 opponents.\n\nSide Note: All of this was a huge pain, and there is likely a much easier way to do this. Below is all the code of making data frames and joining them together until I have something that works for showing the distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbig6_Home <-\n  soccerTidy |>\n  filter(HomeTeam %in% c('Arsenal', 'Liverpool', 'Man United', 'Man City', 'Chelsea', 'Tottenham')) |>\n    filter(!(AwayTeam %in% c('Arsenal', 'Liverpool', 'Man United', 'Man City', 'Chelsea', 'Tottenham')))\n\nbig6_Away <-\n  soccerTidy |>\n  filter(AwayTeam %in% c('Arsenal', 'Liverpool', 'Man United', 'Man City', 'Chelsea', 'Tottenham')) |>\n  filter(!(HomeTeam %in% c('Arsenal', 'Liverpool', 'Man United', 'Man City', 'Chelsea', 'Tottenham')))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbig6_fouls <-\n  big6_Home |>\n    group_by(HomeTeam) |>\n  mutate('Big_6' = 'Yes') |>\n  select(HomeTeam, HomeFouls, Big_6)\n\nopp_fouls <-\n  big6_Home |>\n    group_by(HomeTeam) |>\n  mutate('Big_6' = 'No') |>\n  select(HomeTeam, AwayFouls, Big_6)\n\nhome_fouls <-\n  bind_rows(big6_fouls, opp_fouls) |>\n  pivot_longer(cols = c('HomeFouls', 'AwayFouls'),\n               names_to = 'Location',\n               values_to = 'Fouls') |>\n  select(-(Location)) |>\n  na.omit() |>\n  mutate(Location = 'Home')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nAbig6_fouls <-\n  big6_Away |>\n    group_by(AwayTeam) |>\n  mutate('Big_6' = 'Yes') |>\n  select(AwayTeam, AwayFouls, Big_6)\n\nAopp_fouls <-\n  big6_Away |>\n    group_by(AwayTeam) |>\n  mutate('Big_6' = 'No') |>\n  select(AwayTeam, HomeFouls, Big_6)\n\naway_fouls <-\n  bind_rows(Abig6_fouls, Aopp_fouls) |>\n  pivot_longer(cols = c('HomeFouls', 'AwayFouls'),\n               names_to = 'Location',\n               values_to = 'Fouls') |>\n  select(-(Location)) |>\n  na.omit() |>\n  mutate(Location = 'Away') |>\n  rename('HomeTeam' = AwayTeam)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfouls_df <-\n  bind_rows(home_fouls, away_fouls) |>\n  mutate(Big_6 = as_factor(Big_6))\n```\n:::\n\n\n# Plot 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#|fig-width: 12\nggplot(data = fouls_df,\n       aes(x = HomeTeam,\n           y = Fouls,\n           fill = Big_6)) +\n  geom_boxplot(position = position_dodge(width = 1)) +\n  facet_wrap(vars(Location)) +\n  theme_minimal() +\n  theme(axis.title = element_text(size = 14,),\n        strip.text = element_text(size = 12),\n        strip.background = element_rect(colour = \"black\",\n                                        fill = \"ivory\"),\n        axis.title.y = element_blank(),\n        plot.title = element_text(size = 16,\n                                  hjust = 0),\n        panel.spacing = unit(2, 'lines'),\n        panel.background = element_rect(fill = \"ivory\"),\n        plot.background = element_rect(fill = \"ivory\"),\n        plot.caption = element_text(hjust = 1.33)) +\n  labs(title = 'Distribution of Fouls in Big 6 Games Both Home and Away',\n       caption = '(based on data from Evan Gower via Kaggle)',\n       y = 'Number of Fouls',\n       fill = 'In Big 6?') +\n  coord_flip() +\n  scale_fill_brewer(palette = 'Pastel2')\n```\n\n::: {.cell-output-display}\n![](blog-post-2_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nThis plot shows the distribution of fouls for all the Big 6 teams both home and away as well as their opponents. When I had this idea, I was expecting to see a somewhat lower distribution for all of the Big 6 teams relative to their opponent, but I was surprised. For the most part, the fouls seam relatively even with the biggest advantage appearing to be Arsenal in home games. Below I created a table to show the average number of fouls per game for each Big 6 team.\n\n# Table 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntb6 <-\nfouls_df |>\n  filter(Big_6 == 'Yes') |>\n  group_by(HomeTeam) |>\n  summarise('Fouls per Game for Big 6 Teams' = mean(Fouls))\n\ntb <-\n  fouls_df |>\n  filter(Big_6 == 'No') |>\n  group_by(HomeTeam) |>\n  summarise('Fouls per Game for Opponents' = mean(Fouls)) |>\n  select(-HomeTeam)\n\ntb <-\n  bind_cols(tb6, tb)\n\nkable(tb)\n```\n\n::: {.cell-output-display}\n|HomeTeam   | Fouls per Game for Big 6 Teams| Fouls per Game for Opponents|\n|:----------|------------------------------:|----------------------------:|\n|Arsenal    |                       9.285714|                    10.321429|\n|Chelsea    |                      11.214286|                    10.750000|\n|Liverpool  |                       9.214286|                     8.000000|\n|Man City   |                       8.321429|                     8.607143|\n|Man United |                      10.357143|                     8.464286|\n|Tottenham  |                      10.357143|                    10.535714|\n:::\n:::\n\n\nThis table shows that only a few Big 6 teams average less than their opponents, those being Arsenal, Man City, and Tottenham. I would say that for the most part, this shows that there isn't bias towards the Big 6.\n\n# Conclusion\n\nUltimately, it seems as if there isn't bias towards the Big 6 in terms of the number of fouls for them and for their opponents. As well, I was hoping to create some form of model to predict this, but it wasn't a good possibility with this data set. Looking to the future, I likely would have added in another question and made a new visual as this one is super busy and not the best to interpret, but the process to get there took a while so I've decided to keep it. I might come back to this data in the future to try and answer a different question.\n\n# Connections to Class \n\nI used many techniques we've learned in class in this post. Some being the dplyr tools such as filtering and selecting, binding and merging tables. I also used most of the ggplot techniques from faceting, flipping the coordinates, and adjusting the theme elements to make it look nicer.\n",
    "supporting": [
      "blog-post-2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}